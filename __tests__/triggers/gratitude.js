const { trigger: gratitudeTrigger, outgoingGratitudeResponseStickerId } = require('../../triggers/gratitude');
const { enqueueMessage } = require('../../outgoing-messages');
jest.mock('../../outgoing-messages');

const triggerDescription = 'gratitude trigger';

describe(triggerDescription, () => {
  beforeEach(() => {
    enqueueMessage.mockClear();
  });

  test.each([
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ! ðŸ™â™¥ðŸ™'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ð¾Ñ‡ÐºÐ°))'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ Ð’Ð°Ñ!. ðŸ˜'],
    ['Ð‘Ð»Ð°Ð½Ð¾Ð´Ð°Ñ€ÑŽ'],
    ['ðŸ™‚Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾!'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾'],
    ['Ð¡ÑÐ±'],
    ['Ð¿Ð°ÑÐ¸Ð±Ð°'],
    ['Ð¡Ð¿Ð¾ÑÐ¸Ð±Ð¾'],
    ['ÑÐ¿Ñ â˜º'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾Ñ‡ÐºÐ¸'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±ÐºÐ¸'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±)'],
    ['Ð¡Ð¿Ð²ÑÐ¸Ð±Ð¾'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾!ðŸ™Œ'],
    ['ÐŸÐ°ÑÐ¸Ð±Ð°Ð°Ð°!!! ðŸ¥°ðŸ¥³ðŸ¥³ðŸ¥³ðŸ˜œðŸ’ƒðŸ’ƒðŸ’ƒ'],

    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ!'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð± Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ)'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ â˜ºï¸'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ ðŸ˜‡'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾ÐµðŸ™ƒ'],

    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾, Ð´Ð¾Ñ€Ð¾Ð³Ð¾Ð¹!)'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð’Ð°Ð¼.'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾, Ð±Ñ€Ð¾'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾, Ð¼Ð¾Ð¹ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¸Ð¹!'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð´Ñ€ÑƒÐ³!'],
    
    ["Bol'shoye spasibo! ðŸ‘"],
    
    ['ÐžÑ‚ Ð’ÑÐµÐ¹ Ð”ÑƒÑˆÐ¸âœ‹ðŸ‘‹'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½! ÐžÑ‚ Ð²ÑÐµÐ¹ Ð´ÑƒÑˆÐ¸ Ð‘Ð›ÐÐ“ÐžÐ”ÐÐ Ð®!'],
    ['ÐžÑ‚ Ð´ÑƒÑˆÐ¸ Ð±Ñ€Ð°Ñ‚, ÑÐ¿Ð°ÑÐ¸Ð±Ð¾!'],

    ['ÐžÑ‚ Ð´ÑƒÑˆÐ¸ ÑÐ¿Ð°ÑÐ¸Ð±Ð¾'],
    ['ÐžÑ‚ Ð´ÑƒÑˆÐ¸ ðŸ¤'],
    
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ, Ð¼Ð½Ðµ Ð¿Ñ€Ð¸ÑÑ‚Ð½Ð¾âœ¨âœ¨âœ¨'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ! ÐžÑ‡ÐµÐ½ÑŒ Ð¿Ñ€Ð¸ÑÑ‚Ð½Ð¾!'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾ÐµðŸ™ðŸ’•!!! ÐœÐ½Ðµ Ð¾Ñ‡ÐµÐ½ÑŒ Ð¿Ñ€Ð¸ÑÑ‚Ð½Ð¾!)))'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ, Ð¾Ñ‡ÐµÐ½ÑŒ Ð¿Ñ€Ð¸ÑÑ‚Ð½Ð¾.)'],

    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ!'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ðŸ¤'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ðŸŒ¹'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ, ÑÐ¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ,,!'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ð¸Ð¼ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ!'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ðŸ˜‰'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ!'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð·Ð° Ñ‚Ñ‘Ð¿Ð»Ñ‹Ðµ ÑÐ»Ð¾Ð²Ð°))ðŸ¤ðŸ’ªðŸ˜Š'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ ÑÑƒÐ´Ð°Ñ€ÑŒ Ð·Ð° Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ!'],
    
    ['Ð‘Ð»Ð°Ð³Ð¾Ð”Ð°Ñ€ÑŽ! Ð¸ Ñ‚Ðµ Ð±Ð»Ð°Ð³Ð¾Ð³Ð¾!'],

    ['ÐŸÑ€Ð¸Ð²ÐµÑ‚!)\nÐ¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð¾Ð³Ñ€Ð¾Ð¼Ð½Ð¾Ðµ â˜º'],
    ['ÐŸÑ€Ð¸Ð²ÐµÑ‚ ðŸ‘‹ Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ ðŸ’žðŸ’žðŸ’žðŸ’ž'],
    ['Ð—Ð´Ñ€Ð°Ð²ÑÑ‚Ð²ÑƒÐ¹ ! Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ â˜º'],
    ['Ð—Ð´Ñ€Ð°Ð²ÑÑ‚Ð²ÑƒÐ¹Ñ‚Ðµ! Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ Ð’Ð°Ñ'],
    ['Ð—Ð´Ñ€Ð°Ð²ÑÑ‚Ð²ÑƒÐ¹Ñ‚Ðµ ÑÐ¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ!'],
    ['ÐŸÑ€Ð¸Ð²ÐµÑ‚Ð¸Ðº, ÑÐ¿Ð°ÑÐ¸Ð±Ð¾ Ð¾Ð³Ñ€Ð¾Ð¼Ð½Ð¾Ðµ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ) â¤â€ðŸ©¹ðŸ˜š'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ, Ð¾Ñ‡ÐµÐ½ÑŒ Ð¿Ñ€Ð¸ÑÑ‚Ð½Ð¾!ðŸ™ðŸ™‚'],
    ['Ð”Ð¾Ð±Ñ€Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ! Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ, Ð¾Ñ‡ÐµÐ½ÑŒ Ð¿Ñ€Ð¸ÑÑ‚Ð½Ð¾!ðŸ™ðŸ™‚'],
    ['Ð”Ð¾Ð±Ñ€Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ, ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½! Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ðŸ¤'],
    ['Ð”Ð¾Ð±Ñ€Ñ‹Ð¹ Ð²ÐµÑ‡ÐµÑ€ Ð¸ Ð¾Ð³Ñ€Ð¾Ð¼Ð½Ð¾Ðµ ÑÐ¿Ð°ÑÐ¸Ð±Ð¾!'],
    ['Ð”Ð¾Ð±Ñ€Ð¾Ð³Ð¾ Ð´Ð½Ñ! Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ â˜ºï¸'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð·Ð° Ð´Ð¾Ð±Ñ€Ñ‹Ðµ Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸ÑðŸ™‚ðŸ¤—ðŸŒž'],

    ['ÐšÐ¾ÑÑ‚Ñ ÑÐ¿Ð°ÑÐ¸Ð±Ð¾ â¤'],
    ['ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½, Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ!'],
    ['ÐžÐ³Ñ€Ð¾Ð¼Ð½ÐµÐ¹ÑˆÐµÐµ ÑÐ¿Ð°ÑÐ¸Ð±Ð¾ ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½!ðŸ‘'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ, ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½!) ðŸ™'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½!'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð¸ Ð¿Ð¾Ð¶ÐµÐ»Ð°Ð½Ð¸Ñ, ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½!!!'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾, ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½!'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ ÐšÐ¾ÑÑ‚ÑŒ) ðŸ¤ðŸ¤ðŸ¤'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ ÐšÐ¾ÑÑ‚ÑŒ!!!'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾, ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½! ðŸ’¥'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ ÐšÐ¾ÑÑ‚Ñ ))) Ð¡ÐµÑ€Ð´ÐµÑ‡Ð½Ð¾)'],
    ['ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½ Ð¿Ñ€Ð¸Ð²ÐµÑ‚! Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ!â˜ºðŸ‘'],
    ['ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½, Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð’Ð°Ð¼ ÑÐ¿Ð°ÑÐ¸Ð±Ð¾ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ!!!'],
    ['ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½, Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ Ð’Ð°Ñ Ð·Ð° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ!'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ, ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½!'],
    ['ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½, ÑÐ¿Ð°ÑÐ¸Ð±Ð¾!'],
    ['ÐšÐ¾ÑÑ‚ÑÐ½, ÑÐ¿Ð°ÑÐ¸Ð±Ð¾'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ Ñ‚ÐµÐ±Ñ ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½ ðŸ«¶'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ ÐšÐ¾ÑÑ‚Ñ'],
    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½! ðŸ¤'],

    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð¼ÑƒÐ¶Ð¸Ðº!ðŸ’ªðŸ»ðŸŽ‰ Ð¾Ð±Ð½ÑÐ» Ð¿Ð¾Ð´Ð½ÑÐ» ðŸ™ƒ'],
    ['Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ Ð´Ð¾Ð±Ñ€Ð° Ð¸ Ð»ÑŽÐ±Ð²Ð¸ Ñ‚Ð²Ð¾ÐµÐ¼Ñƒ Ð´Ð¾Ð¼Ñƒ'],

    ['Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ ÑÐ¿Ð°ÑÐ¸Ð±Ð¾ ÑÐ¿Ð°ÑÐ¸Ð±Ð¾!!!â˜ºï¸'],

    ['Thanks you'],
    ['Thank you'],
  ])(`"%s" message matches ${triggerDescription} and gives expected response`, (incomingMessage) => {
    // console.log('incomingMessage', incomingMessage);
    const context = { request: { isFromUser: true, isOutbox: false, text: incomingMessage } };
    expect(gratitudeTrigger.condition(context)).toBe(true);
    if (gratitudeTrigger.condition(context)) {
      gratitudeTrigger.action(context);
    }
    expect(enqueueMessage).toHaveBeenCalled();
    const callArg = enqueueMessage.mock.calls[0][0];
    expect(callArg).toEqual(expect.objectContaining(context));
    expect(callArg.response.sticker_id).toEqual(outgoingGratitudeResponseStickerId);
  });

  test.each([
    [86140],  // Ð‘Ð›ÐÐ“ÐžÐ”ÐÐ Ð®
    [57689],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [53771],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [100140], // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž â™¡
    [95564],  // Ð‘Ð›ÐÐ“ÐžÐ”ÐÐ Ð®
    [74836],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž!
    [88368],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [13457],  // Ð‘Ð›ÐÐ“ÐžÐ”ÐÐ Ð®
    [61452],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [17925],  // Ð‘Ð›ÐÐ“ÐžÐ”ÐÐ Ð®
    [89254],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž!
    [76589],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [54085],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [51599],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [71370],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘ÐžÐ§ÐšÐ˜
    [66424],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž!
    [12995],  // Ð¡ÐŸÐÐ¡Ð˜Ð˜Ð˜Ð‘Ðž
    [15897],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [73618],  // ÐœÐ•Ð Ð¡Ð˜
    [3698],   // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [68782],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [13428],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘ÐšÐ˜
    [58613],  // ÐžÐ¢ Ð”Ð£Ð¨Ð˜
    [94365],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [12673],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [10253],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž!
    [65703],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [94568],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [20406],  // Ð¡ÐŸÐÐ¡Ð˜Ð˜Ð˜Ð‘Ð!
    [86539],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž!
    [6164],   // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [91892],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž!
    [51266],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
    [72149],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž, Ð—ÐÐ®Ð¨
    [94594],  // Ð¡ÐŸÐÐ¡Ð˜Ð‘Ðž
  ])(`"%s" sticker matches ${triggerDescription} and gives expected response`, (incomingStickerId) => {
    // console.log('incomingMessage', incomingMessage);
    const context = { request: { isFromUser: true, isOutbox: false, attachments: [{ id: incomingStickerId }] } };
    expect(gratitudeTrigger.condition(context)).toBe(true);
    if (gratitudeTrigger.condition(context)) {
      gratitudeTrigger.action(context);
    }
    expect(enqueueMessage).toHaveBeenCalled();
    const callArg = enqueueMessage.mock.calls[0][0];
    expect(callArg).toEqual(expect.objectContaining(context));
    expect(callArg.response.sticker_id).toEqual(outgoingGratitudeResponseStickerId);
  });
});