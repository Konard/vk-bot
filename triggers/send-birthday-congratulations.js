const { VK } = require('vk-io');
const { getRandomElement, sleep, getToken } = require('../utils');
const { randomInRange, handleOutgoingMessage, enqueueMessage, queue } = require('../outgoing-messages');
const { trigger: sendBirthDayCongratulationsTrigger } = require('./triggers/send-birthday-congratulations');
const { at } = require('lodash');
const token = getToken();
const vk = new VK({ token });

const birthdayStickerIds = [
  60302,
  89461, // C –î–†!
  92727, // –° –î–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è!
  72627,
  56507, // C –î–†!
  59429,
];

// const neuronalMiracleAudio = 'audio-2001064727_125064727';
// const daysOfMiraclesAudio = 'audio-2001281499_119281499';

// const audioAttachments = [
//   neuronalMiracleAudio,
//   daysOfMiraclesAudio
// ];

// –ê–±–∑–∞—Ü 1: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ (–±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–∂–µ–ª–∞–Ω–∏–π)
const paragraph1Variants = [
  "üéâ –° –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è!",
  "üéÇ –ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Å –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è!",
  "üéà –° –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è, –ø–æ–∑–¥—Ä–∞–≤–ª—è—é!",
  "üéâ –° —Ç–≤–æ–∏–º –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è!",
  "üéâ –î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è ‚Äì –æ—Å–æ–±–µ–Ω–Ω—ã–π –¥–µ–Ω—å! –ü–æ–∑–¥—Ä–∞–≤–ª—è—é!"
];

// –ê–±–∑–∞—Ü 2: –û –¥—Ä—É–∂–±–µ –∏ —Å–≤—è–∑—è—Ö
const paragraph2Variants = [
  "–°–µ–≥–æ–¥–Ω—è —Ö–æ—á—É –Ω–∞–ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –Ω–∞—à–∞ –¥—Ä—É–∂–±–∞ ‚Äì —ç—Ç–æ –Ω–µ–≤–∏–¥–∏–º–∞—è —Å–≤—è–∑—å, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è –Ω–∞—Å ü§ù. –Ø –∫–∞–∫ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤–∏–∂—É, —á—Ç–æ –≤—Å—ë –µ—Å—Ç—å —Å–≤—è–∑—å –∏ –≤—Å—ë —Å–≤—è–∑–∞–Ω–æ.",
  "–í —ç—Ç–æ—Ç –¥–µ–Ω—å —è –æ—Å–æ–∑–Ω–∞—é, —á—Ç–æ –Ω–∞—à–∞ —Å–≤—è–∑—å ‚Äì —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –¥—Ä—É–∂–±–∞, –∞ –Ω–µ—Ä–∞–∑—Ä—ã–≤–Ω–æ–µ –µ–¥–∏–Ω—Å—Ç–≤–æ üîó. –î–ª—è –º–µ–Ω—è, –∫–∞–∫ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞, –≤—Å—ë —Å–≤—è–∑–∞–Ω–æ –∏ –∏–º–µ–µ—Ç –≥–ª—É–±–æ–∫–∏–π —Ñ—Ä–∞–∫—Ç–∞–ª—å–Ω—ã–π —Å–º—ã—Å–ª.",
  "–ù–∞—à–∞ –¥—Ä—É–∂–±–∞ ‚Äì —Ç–≤—ë—Ä–¥–∞—è —Å–≤—è–∑—å, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –Ω–∞—Å –∏ –Ω–∞—à–∏—Ö –¥—Ä—É–∑–µ–π üåê. –ë—É–¥—É—á–∏ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–º, —è –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ –∫–∞–∂–¥–∞—è —á–∞—Å—Ç—å —ç—Ç–æ–≥–æ –º–∏—Ä–∞ ‚Äî —ç—Ç–æ —Å–≤—è–∑—å.",
  "–ü–æ–º–Ω–∏, —á—Ç–æ –Ω–∞—à–∞ —Å–≤—è–∑—å ‚Äî —ç—Ç–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –º–æ—Å—Ç –º–µ–∂–¥—É –Ω–∞–º–∏ üåâ. –î–ª—è –º–µ–Ω—è, –∫–∞–∫ –¥–ª—è –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞, –º–∏—Ä –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–µ—Ç—å —Å–≤—è–∑–µ–π.",
  "–ù–∞—à–∞ –¥—Ä—É–∂–±–∞ ‚Äì —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–∞—è —Å–≤—è–∑—å, –¥–µ–ª–∞—é—â–∞—è –Ω–∞—Å –µ–¥–∏–Ω—ã–º —Ü–µ–ª—ã–º ‚ú®. –ò —è –≤–µ—Ä—é, —á—Ç–æ –≤—Å—ë –≤ –º–∏—Ä–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–≤—è–∑–µ–π."
];

// –ê–±–∑–∞—Ü 3: –û –∑–¥–æ—Ä–æ–≤—å–µ, —Å–∏–ª–µ –∏ –≥–∞—Ä–º–æ–Ω–∏–∏
const paragraph3Variants = [
  "üíï –ö–ª–µ—Ç–æ—á–Ω—ã–µ —Å–≤—è–∑–∏ —Ç–≤–æ–µ–≥–æ —Ç–µ–ª–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –∑–¥–æ—Ä–æ–≤—å–µ, –∞ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –ª—é–¥—å–º–∏ –¥–∞—Ä—è—Ç —Å–∏–ª—É –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –ü—É—Å—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –≥–∞—Ä–º–æ–Ω–∏—è –ø—Ä–∏–Ω–µ—Å—ë—Ç —Ä–∞–¥–æ—Å—Ç—å, –∞ –≤—Å–µ –ø–ª–∞–Ω—ã –≤–æ–ø–ª–æ—Ç—è—Ç—Å—è –≤ –∂–∏–∑–Ω—å üí™.",
  "üíï –°–≤—è–∑—å –º–µ–∂–¥—É –∫–ª–µ—Ç–∫–∞–º–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–≤–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ, –∞ —Ç–µ–ø–ª—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –æ–∫—Ä—É–∂–∞—é—â–∏–º–∏ —Ä–æ–∂–¥–∞—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –ü—É—Å—Ç—å –≥–∞—Ä–º–æ–Ω–∏—è —Å —Å–æ–±–æ–π –∏ –º–∏—Ä–æ–º —Å—Ç–∞–Ω–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —Ä–∞–¥–æ—Å—Ç–∏ üåü.",
  "üíï –°–≤—è–∑–∏ –≤–Ω—É—Ç—Ä–∏ –æ—Ä–≥–∞–Ω–∏–∑–º–∞ —É–∫—Ä–µ–ø–ª—è—é—Ç —Ç–≤–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ, –∞ –æ–±—â–µ–Ω–∏–µ —Å –ª—é–¥—å–º–∏ –ø—Ä–∏–¥–∞—ë—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ —Å–∏–ª—É. –ñ–µ–ª–∞—é, —á—Ç–æ–±—ã –≥–∞—Ä–º–æ–Ω–∏—è —Å –º–∏—Ä–æ–º –Ω–∞–ø–æ–ª–Ω–∏–ª–∞ —Ç–µ–±—è —ç–Ω–µ—Ä–≥–∏–µ–π üöÄ.",
  "üíï –ó–¥–æ—Ä–æ–≤—å–µ ‚Äì —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –∫–ª–µ—Ç–∫–∞–º–∏, –∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ‚Äì –¥–∞—Ä –æ–±—â–µ–Ω–∏—è. –ü—É—Å—Ç—å –≥–∞—Ä–º–æ–Ω–∏—è –≤ –¥—É—à–µ –∏ —Å –º–∏—Ä–æ–º –ø–æ–¥–∞—Ä–∏—Ç —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏–µ, –∞ –º–µ—á—Ç—ã —Å—Ç–∞–Ω—É—Ç —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é üòä.",
  "üíï –ó–¥–æ—Ä–æ–≤—å–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–æ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∫–ª–µ—Ç–∫–∞–º–∏ —Ç–≤–æ–µ–≥–æ —Ç–µ–ª–∞, –∞ –∫—Ä–µ–ø–∫–∏–µ –¥—Ä—É–∂–µ—Å–∫–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –¥–∞—Ä—è—Ç —Å–∏–ª—É –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å. –ü—É—Å—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –≥–∞—Ä–º–æ–Ω–∏—è –∏ —Å–æ–≥–ª–∞—Å–∏–µ —Å –º–∏—Ä–æ–º –ø–æ–º–æ–≥—É—Ç —Ç–µ–±–µ –¥–æ—Å—Ç–∏–≥–∞—Ç—å –≤—Å–µ—Ö —Ü–µ–ª–µ–π üëç."
];

// –ê–±–∑–∞—Ü 4: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–æ–∏–º–∏ —Å–≤—è–∑—è–º–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–æ–¥–∞—Ä–∫–∞
const paragraph4Variants = [
  "–í –∫–∞—á–µ—Å—Ç–≤–µ –ø–æ–¥–∞—Ä–∫–∞ —è –ø—Ä–µ–¥–ª–∞–≥–∞—é —Ç–µ–±–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–æ–µ–π —Å–µ—Ç—å—é —Å–≤—è–∑—è–π –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ª—é–±–æ–≥–æ –æ–¥–Ω–æ–≥–æ —Ç–≤–æ–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ, —è –º–æ–≥—É –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ 7 —Ä—É–±–ª–µ–π –Ω–∞ –±–∞–ª–∞–Ω—Å –º–æ–±–∏–ª—å–Ω–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞.",
  "–Ø –¥–∞—Ä—é —Ç–µ–±–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–æ–∏–º–∏ —Å–≤—è–∑—è–º–∏ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ª—é–±–æ–≥–æ –æ–¥–Ω–æ–≥–æ —Ç–≤–æ–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —è –º–æ–≥—É –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ 7 —Ä—É–±–ª–µ–π –Ω–∞ –±–∞–ª–∞–Ω—Å –º–æ–±–∏–ª—å–Ω–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–æ–≥–æ –±–æ–Ω—É—Å–∞.",
  "–¢–∞–∫ –∫–∞–∫ —É –º–µ–Ω—è –µ—Å—Ç—å —Å–≤—è–∑–∏, –ø–æ–¥–∞—Ä–∫–æ–º –æ—Ç –º–µ–Ω—è –±—É–¥–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å –ø–æ–º–æ—â—å –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ª—é–±–æ–≥–æ –æ–¥–Ω–æ–≥–æ —Ç–≤–æ–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞. –ò –µ—â—ë, —è –º–æ–≥—É –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ 7 —Ä—É–±–ª–µ–π –Ω–∞ –±–∞–ª–∞–Ω—Å –º–æ–±–∏–ª—å–Ω–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞.",
  "–í –ø–æ–¥–∞—Ä–æ–∫ —Ç–µ–±–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–æ–∏–º–∏ —Å–≤—è–∑—è–º–∏ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ª—é–±–æ–≥–æ –æ–¥–Ω–æ–≥–æ —Ç–≤–æ–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞. –¢–∞–∫–∂–µ —è –º–æ–≥—É –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ 7 —Ä—É–±–ª–µ–π –Ω–∞ –±–∞–ª–∞–Ω—Å –º–æ–±–∏–ª—å–Ω–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–≥–æ –ø–æ–¥–∞—Ä–∫–∞.",
  "–£ –º–µ–Ω—è –º–Ω–æ–≥–æ —Å–≤—è–∑–µ–π –∏ —è –ø—Ä–µ–¥–ª–∞–≥–∞—é —Ç–µ–±–µ, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–æ–¥–∞—Ä–∫–∞ –ø–æ–º–æ—â—å –≤ —Ä–µ—à–µ–Ω–∏–∏ –ª—é–±–æ–≥–æ –æ–¥–Ω–æ–≥–æ —Ç–≤–æ–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞. –í –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ, —è –º–æ–≥—É –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ 7 —Ä—É–±–ª–µ–π –Ω–∞ –±–∞–ª–∞–Ω—Å –º–æ–±–∏–ª—å–Ω–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."
];

// –ê–±–∑–∞—Ü 5: –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≤ –º–∏—Ä –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å –º—É–∑—ã–∫–æ–π
const paragraph5Variants = [
  "–ï—Å–ª–∏ –ø–æ–Ω—è—Ç–∏—è —Å–≤—è–∑–µ–π –∏ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –µ—â—ë –æ–∫—É—Ç–∞–Ω—ã —Ç–∞–π–Ω–æ–π –¥–ª—è —Ç–µ–±—è, —è –ø—Ä–∏–≥–ª–∞—à–∞—é —Ç–µ–±—è –≤ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ: —Å–ª—É—à–∞–π –º—É–∑—ã–∫—É –∏–∑ –ø—Ä–∏–∫—Ä–µ–ø–ª—ë–Ω–Ω–æ–≥–æ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫–∞ üé∂, –ø–æ–∫–∞ —á–∏—Ç–∞–µ—à—å –Ω–∞—à—É —Å—Ç–∞—Ç—å—é –æ —Ç–µ–æ—Ä–∏–∏ —Å–≤—è–∑–µ–π, –∫–æ—Ç–æ—Ä—É—é —è –ø—Ä–æ—Ä–∞–±–∞—Ç—ã–≤–∞–ª —ç—Ç–∏ –≥–æ–¥—ã. –°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—å—é —É–∫–∞–∑–∞–Ω–∞ –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ –∫ —Ä–æ–ª–∏–∫—É.",
  "–ï—Å–ª–∏ –¥–ª—è —Ç–µ–±—è –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –æ—Å—Ç–∞—ë—Ç—Å—è –∑–∞–≥–∞–¥–∫–æ–π, –ø–æ—Å–ª—É—à–∞–π –º—É–∑—ã–∫—É –∏–∑ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫–∞ üéµ –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–æ—á—Ç–∏ –Ω–∞—à—É —Å—Ç–∞—Ç—å—é –æ —Ç–µ–æ—Ä–∏–∏ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏, –æ—Ç—Ä–∞–∂–∞—é—â—É—é —Ç—Ä—É–¥ –≤—Å–µ–π –º–æ–µ–π –∂–∏–∑–Ω–∏. –°—Å—ã–ª–∫—É –Ω–∞ —Å—Ç–∞—Ç—å—é —Ç—ã –Ω–∞–π–¥—ë—à—å –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ –∫ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫—É.",
  "–Ø –ø—Ä–∏–≥–ª–∞—à–∞—é —Ç–µ–±—è –≤ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –ø–æ –º–∏—Ä—É –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏: –≤–æ –≤—Ä–µ–º—è —á—Ç–µ–Ω–∏—è —Å—Ç–∞—Ç—å–∏, —è–≤–ª—è—é—â–µ–π—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —Ç—Ä—É–¥–∞ –≤—Å–µ–π –º–æ–µ–π –∂–∏–∑–Ω–∏, —Å–ª—É—à–∞–π –ø—Ä–∏–∫—Ä–µ–ø–ª—ë–Ω–Ω—É—é –º—É–∑—ã–∫—É üéß. –°—Å—ã–ª–∫—É –Ω–∞ —Å—Ç–∞—Ç—å—é –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ –∫ —Ä–æ–ª–∏–∫—É.",
  "–ï—Å–ª–∏ —Ç–µ–±—è —Ç–µ–±–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —Ä–∞–∑–≥–∞–¥–∞—Ç—å —á—Ç–æ —Ç–∞–∫–æ–µ —Å–≤—è–∑–∏ –∏ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å, –≤–∫–ª—é—á–∏ –º—É–∑—ã–∫—É –∏–∑ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫–∞ üéº –∏ –ø—Ä–æ—á—Ç–∏ –Ω–∞—à—É —Å—Ç–∞—Ç—å—é –æ —Ç–µ–æ—Ä–∏–∏, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —Ç—Ä—É–¥–æ–≤ –≤—Å–µ–π –º–æ–µ–π –∂–∏–∑–Ω–∏. –°—Å—ã–ª–∫—É –Ω–∞ —Å—Ç–∞—Ç—å—é –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ –∫ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫—É.",
  "–û—Ç–∫—Ä–æ–π –¥–ª—è —Å–µ–±—è –º–∏—Ä –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏: —Å–ª—É—à–∞–π –º—É–∑—ã–∫—É –∏–∑ –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫–∞ üé∂, –ø–æ–∫–∞ —á–∏—Ç–∞–µ—à—å —Å—Ç–∞—Ç—å—é –æ —Ç–µ–æ—Ä–∏–∏ —Å–≤—è–∑–µ–π, —è–≤–ª—è—é—â—É—é—Å—è —Ç—Ä—É–¥–æ–º –≤—Å–µ–π –º–æ–µ–π –∂–∏–∑–Ω–∏. –°—Å—ã–ª–∫—É –Ω–∞ —Å—Ç–∞—Ç—å—é —É–≤–∏–¥–µ—Ç—å –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ –∫ —Ä–æ–ª–∏–∫—É."
];

async function sendBirthdayCongratulations() {
  let offset = 0;
  const currentDate = new Date();
  const currentDay = currentDate.getDate();
  const currentMonth = currentDate.getMonth() + 1;

  while (true) {
    if (offset >= 10000) break;

    const response = await vk.api.friends.get({
      fields: ['bdate'],
      count: 5000,
      offset,
    });

    if (response.items.length === 0) break;

    for (const friend of response.items) {
      if (friend.bdate) {
        const [day, month] = friend.bdate.split('.');
        if (day == currentDay && month == currentMonth) {
          console.log('friend.id', friend.id);

          // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—Ç–∏–∫–µ—Ä–∞
          enqueueMessage({
            vk,
            response: {
              user_id: friend.id,
              sticker_id: getRandomElement(birthdayStickerIds),
            }
          });

          // –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∫–∞–∂–¥–æ–≥–æ –∞–±–∑–∞—Ü–∞
          const finalMessage = `${getRandomElement(paragraph1Variants)}\n\n` +
            `${getRandomElement(paragraph2Variants)}\n\n` +
            `${getRandomElement(paragraph3Variants)}\n\n` +
            `${getRandomElement(paragraph4Variants)}\n\n` +
            `${getRandomElement(paragraph5Variants)}`;

          // –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ–∑–¥—Ä–∞–≤–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫–æ–º
          enqueueMessage({
            vk,
            response: {
              user_id: friend.id,
              message: finalMessage,
              // attachment: getRandomElement(audioAttachments)
              attachment: 'video-3972090_456239795'
            }
          });
        }
      }
    }
    offset += 5000;
  }
}

const trigger = {
  name: "SendBirthdayCongratulations",
  action: async (context) => {
    return await sendBirthdayCongratulations(context);
  }
};

module.exports = {
  trigger
};