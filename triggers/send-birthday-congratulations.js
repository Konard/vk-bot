const { VK } = require('vk-io');
const { getRandomElement, sleep, getToken } = require('../utils');
const { randomInRange, handleOutgoingMessage, enqueueMessage, queue } = require('../outgoing-messages');
const { trigger: sendBirthDayCongratulationsTrigger } = require('./triggers/send-birthday-congratulations');
const { at } = require('lodash');
const token = getToken();
const vk = new VK({ token });

const birthdayStickerIds = [
  60302,
  89461, // C Ð”Ð !
  92727, // Ð¡ Ð”Ð½Ñ‘Ð¼ Ñ€Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ!
  72627,
  56507, // C Ð”Ð !
  59429,
];

// const neuronalMiracleAudio = 'audio-2001064727_125064727';
// const daysOfMiraclesAudio = 'audio-2001281499_119281499';

// const audioAttachments = [
//   neuronalMiracleAudio,
//   daysOfMiraclesAudio
// ];

// ÐÐ±Ð·Ð°Ñ† 1: ÐŸÑ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ðµ (Ð±ÐµÐ· Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¿Ð¾Ð¶ÐµÐ»Ð°Ð½Ð¸Ð¹)
const paragraph1Variants = [
  "ðŸŽ‰ Ð¡ Ð´Ð½Ñ‘Ð¼ Ñ€Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ!",
  "ðŸŽ‚ ÐŸÐ¾Ð·Ð´Ñ€Ð°Ð²Ð»ÑÑŽ Ñ Ð´Ð½Ñ‘Ð¼ Ñ€Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ!",
  "ðŸŽˆ Ð¡ Ð´Ð½Ñ‘Ð¼ Ñ€Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ, Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÑÑŽ!",
  "ðŸŽ‰ Ð¡ Ñ‚Ð²Ð¾Ð¸Ð¼ Ð´Ð½Ñ‘Ð¼ Ñ€Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ!",
  "ðŸŽ‰ Ð”ÐµÐ½ÑŒ Ñ€Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ â€“ Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ! ÐŸÐ¾Ð·Ð´Ñ€Ð°Ð²Ð»ÑÑŽ!"
];

// ÐÐ±Ð·Ð°Ñ† 2: Ðž Ð´Ñ€ÑƒÐ¶Ð±Ðµ Ð¸ ÑÐ²ÑÐ·ÑÑ…
const paragraph2Variants = [
  "Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ Ñ…Ð¾Ñ‡Ñƒ Ð½Ð°Ð¿Ð¾Ð¼Ð½Ð¸Ñ‚ÑŒ, Ñ‡Ñ‚Ð¾ Ð½Ð°ÑˆÐ° Ð´Ñ€ÑƒÐ¶Ð±Ð° â€“ ÑÑ‚Ð¾ Ð½ÐµÐ²Ð¸Ð´Ð¸Ð¼Ð°Ñ ÑÐ²ÑÐ·ÑŒ, Ð¾Ð±ÑŠÐµÐ´Ð¸Ð½ÑÑŽÑ‰Ð°Ñ Ð½Ð°Ñ ðŸ¤. Ð¯ ÐºÐ°Ðº Ð¸ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð°ÑÑÐ¾Ñ†Ð¸Ð°Ñ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸ Ð²Ð¸Ð¶Ñƒ, Ñ‡Ñ‚Ð¾ Ð²ÑÑ‘ ÐµÑÑ‚ÑŒ ÑÐ²ÑÐ·ÑŒ Ð¸ Ð²ÑÑ‘ ÑÐ²ÑÐ·Ð°Ð½Ð¾.",
  "Ð’ ÑÑ‚Ð¾Ñ‚ Ð´ÐµÐ½ÑŒ Ñ Ð¾ÑÐ¾Ð·Ð½Ð°ÑŽ, Ñ‡Ñ‚Ð¾ Ð½Ð°ÑˆÐ° ÑÐ²ÑÐ·ÑŒ â€“ ÑÑ‚Ð¾ Ð½Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð´Ñ€ÑƒÐ¶Ð±Ð°, Ð° Ð½ÐµÑ€Ð°Ð·Ñ€Ñ‹Ð²Ð½Ð¾Ðµ ÐµÐ´Ð¸Ð½ÑÑ‚Ð²Ð¾ ðŸ”—. Ð”Ð»Ñ Ð¼ÐµÐ½Ñ, ÐºÐ°Ðº Ð°ÑÑÐ¾Ñ†Ð¸Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸ÑÑ‚Ð°, Ð²ÑÑ‘ ÑÐ²ÑÐ·Ð°Ð½Ð¾ Ð¸ Ð¸Ð¼ÐµÐµÑ‚ Ð³Ð»ÑƒÐ±Ð¾ÐºÐ¸Ð¹ Ñ„Ñ€Ð°ÐºÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¹ ÑÐ¼Ñ‹ÑÐ».",
  "ÐÐ°ÑˆÐ° Ð´Ñ€ÑƒÐ¶Ð±Ð° â€“ Ñ‚Ð²Ñ‘Ñ€Ð´Ð°Ñ ÑÐ²ÑÐ·ÑŒ, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð¾Ð±ÑŠÐµÐ´Ð¸Ð½ÑÐµÑ‚ Ð½Ð°Ñ Ð¸ Ð½Ð°ÑˆÐ¸Ñ… Ð´Ñ€ÑƒÐ·ÐµÐ¹ ðŸŒ. Ð‘ÑƒÐ´ÑƒÑ‡Ð¸ Ð°ÑÑÐ¾Ñ†Ð¸Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¼ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸ÑÑ‚Ð¾Ð¼, Ñ Ð¿Ð¾Ð½Ð¸Ð¼Ð°ÑŽ, Ñ‡Ñ‚Ð¾ ÐºÐ°Ð¶Ð´Ð°Ñ Ñ‡Ð°ÑÑ‚ÑŒ ÑÑ‚Ð¾Ð³Ð¾ Ð¼Ð¸Ñ€Ð° â€” ÑÑ‚Ð¾ ÑÐ²ÑÐ·ÑŒ.",
  "ÐŸÐ¾Ð¼Ð½Ð¸, Ñ‡Ñ‚Ð¾ Ð½Ð°ÑˆÐ° ÑÐ²ÑÐ·ÑŒ â€” ÑÑ‚Ð¾ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¼Ð¾ÑÑ‚ Ð¼ÐµÐ¶Ð´Ñƒ Ð½Ð°Ð¼Ð¸ ðŸŒ‰. Ð”Ð»Ñ Ð¼ÐµÐ½Ñ, ÐºÐ°Ðº Ð´Ð»Ñ Ð°ÑÑÐ¾Ñ†Ð¸Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸ÑÑ‚Ð°, Ð¼Ð¸Ñ€ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ ÑÐ¾Ð±Ð¾Ð¹ ÑÐµÑ‚ÑŒ ÑÐ²ÑÐ·ÐµÐ¹.",
  "ÐÐ°ÑˆÐ° Ð´Ñ€ÑƒÐ¶Ð±Ð° â€“ ÑƒÐ´Ð¸Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ ÑÐ²ÑÐ·ÑŒ, Ð´ÐµÐ»Ð°ÑŽÑ‰Ð°Ñ Ð½Ð°Ñ ÐµÐ´Ð¸Ð½Ñ‹Ð¼ Ñ†ÐµÐ»Ñ‹Ð¼ âœ¨. Ð˜ Ñ Ð²ÐµÑ€ÑŽ, Ñ‡Ñ‚Ð¾ Ð²ÑÑ‘ Ð² Ð¼Ð¸Ñ€Ðµ ÑÐ¾ÑÑ‚Ð¾Ð¸Ñ‚ Ð¸Ð· ÑÐ²ÑÐ·ÐµÐ¹."
];

// ÐÐ±Ð·Ð°Ñ† 3: Ðž Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÐµ, ÑÐ¸Ð»Ðµ Ð¸ Ð³Ð°Ñ€Ð¼Ð¾Ð½Ð¸Ð¸
const paragraph3Variants = [
  "ðŸ’• ÐšÐ»ÐµÑ‚Ð¾Ñ‡Ð½Ñ‹Ðµ ÑÐ²ÑÐ·Ð¸ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ñ‚ÐµÐ»Ð° Ð¾Ð±ÐµÑÐ¿ÐµÑ‡Ð¸Ð²Ð°ÑŽÑ‚ Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÐµ, Ð° Ð¾Ñ‚Ð½Ð¾ÑˆÐµÐ½Ð¸Ñ Ñ Ð»ÑŽÐ´ÑŒÐ¼Ð¸ Ð´Ð°Ñ€ÑÑ‚ ÑÐ¸Ð»Ñƒ Ð¸ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸. ÐŸÑƒÑÑ‚ÑŒ Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½ÑÑ Ð³Ð°Ñ€Ð¼Ð¾Ð½Ð¸Ñ Ð¿Ñ€Ð¸Ð½ÐµÑÑ‘Ñ‚ Ñ€Ð°Ð´Ð¾ÑÑ‚ÑŒ, Ð° Ð²ÑÐµ Ð¿Ð»Ð°Ð½Ñ‹ Ð²Ð¾Ð¿Ð»Ð¾Ñ‚ÑÑ‚ÑÑ Ð² Ð¶Ð¸Ð·Ð½ÑŒ ðŸ’ª.",
  "ðŸ’• Ð¡Ð²ÑÐ·ÑŒ Ð¼ÐµÐ¶Ð´Ñƒ ÐºÐ»ÐµÑ‚ÐºÐ°Ð¼Ð¸ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ Ñ‚Ð²Ð¾Ðµ Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÐµ, Ð° Ñ‚ÐµÐ¿Ð»Ñ‹Ðµ Ð¾Ñ‚Ð½Ð¾ÑˆÐµÐ½Ð¸Ñ Ñ Ð¾ÐºÑ€ÑƒÐ¶Ð°ÑŽÑ‰Ð¸Ð¼Ð¸ Ñ€Ð¾Ð¶Ð´Ð°ÑŽÑ‚ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸. ÐŸÑƒÑÑ‚ÑŒ Ð³Ð°Ñ€Ð¼Ð¾Ð½Ð¸Ñ Ñ ÑÐ¾Ð±Ð¾Ð¹ Ð¸ Ð¼Ð¸Ñ€Ð¾Ð¼ ÑÑ‚Ð°Ð½ÐµÑ‚ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð¼ Ñ€Ð°Ð´Ð¾ÑÑ‚Ð¸ ðŸŒŸ.",
  "ðŸ’• Ð¡Ð²ÑÐ·Ð¸ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð¼Ð° ÑƒÐºÑ€ÐµÐ¿Ð»ÑÑŽÑ‚ Ñ‚Ð²Ð¾Ðµ Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÐµ, Ð° Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ñ Ð»ÑŽÐ´ÑŒÐ¼Ð¸ Ð¿Ñ€Ð¸Ð´Ð°Ñ‘Ñ‚ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ Ð¸ ÑÐ¸Ð»Ñƒ. Ð–ÐµÐ»Ð°ÑŽ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð³Ð°Ñ€Ð¼Ð¾Ð½Ð¸Ñ Ñ Ð¼Ð¸Ñ€Ð¾Ð¼ Ð½Ð°Ð¿Ð¾Ð»Ð½Ð¸Ð»Ð° Ñ‚ÐµÐ±Ñ ÑÐ½ÐµÑ€Ð³Ð¸ÐµÐ¹ ðŸš€.",
  "ðŸ’• Ð—Ð´Ð¾Ñ€Ð¾Ð²ÑŒÐµ â€“ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ ÑÐ²ÑÐ·ÐµÐ¹ Ð¼ÐµÐ¶Ð´Ñƒ ÐºÐ»ÐµÑ‚ÐºÐ°Ð¼Ð¸, Ð° Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸ â€“ Ð´Ð°Ñ€ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ. ÐŸÑƒÑÑ‚ÑŒ Ð³Ð°Ñ€Ð¼Ð¾Ð½Ð¸Ñ Ð² Ð´ÑƒÑˆÐµ Ð¸ Ñ Ð¼Ð¸Ñ€Ð¾Ð¼ Ð¿Ð¾Ð´Ð°Ñ€Ð¸Ñ‚ ÑƒÐ´Ð¾Ð²Ð»ÐµÑ‚Ð²Ð¾Ñ€ÐµÐ½Ð¸Ðµ, Ð° Ð¼ÐµÑ‡Ñ‚Ñ‹ ÑÑ‚Ð°Ð½ÑƒÑ‚ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒÑŽ ðŸ˜Š.",
  "ðŸ’• Ð—Ð´Ð¾Ñ€Ð¾Ð²ÑŒÐµ Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÑ‚ÑÑ ÑÐ¾ ÑÐ²ÑÐ·Ð¸ Ð¼ÐµÐ¶Ð´Ñƒ ÐºÐ»ÐµÑ‚ÐºÐ°Ð¼Ð¸ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ñ‚ÐµÐ»Ð°, Ð° ÐºÑ€ÐµÐ¿ÐºÐ¸Ðµ Ð´Ñ€ÑƒÐ¶ÐµÑÐºÐ¸Ðµ Ð¾Ñ‚Ð½Ð¾ÑˆÐµÐ½Ð¸Ñ Ð´Ð°Ñ€ÑÑ‚ ÑÐ¸Ð»Ñƒ Ð¸ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ. ÐŸÑƒÑÑ‚ÑŒ Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½ÑÑ Ð³Ð°Ñ€Ð¼Ð¾Ð½Ð¸Ñ Ð¸ ÑÐ¾Ð³Ð»Ð°ÑÐ¸Ðµ Ñ Ð¼Ð¸Ñ€Ð¾Ð¼ Ð¿Ð¾Ð¼Ð¾Ð³ÑƒÑ‚ Ñ‚ÐµÐ±Ðµ Ð´Ð¾ÑÑ‚Ð¸Ð³Ð°Ñ‚ÑŒ Ð²ÑÐµÑ… Ñ†ÐµÐ»ÐµÐ¹ ðŸ‘."
];

// ÐÐ±Ð·Ð°Ñ† 4: Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð²Ð¾ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒÑÑ Ð¼Ð¾Ð¸Ð¼Ð¸ ÑÐ²ÑÐ·ÑÐ¼Ð¸ Ð² ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð¿Ð¾Ð´Ð°Ñ€ÐºÐ°
const paragraph4Variants = [
  "Ð’ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð¿Ð¾Ð´Ð°Ñ€ÐºÐ° Ñ Ð¿Ñ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ Ñ‚ÐµÐ±Ðµ Ð²Ð¾ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒÑÑ Ð¼Ð¾ÐµÐ¹ ÑÐµÑ‚ÑŒÑŽ ÑÐ²ÑÐ·ÑÐ¹ Ð´Ð»Ñ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð»ÑŽÐ±Ð¾Ð³Ð¾ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾, Ñ Ð¼Ð¾Ð³Ñƒ Ð¿ÐµÑ€ÐµÐ²ÐµÑÑ‚Ð¸ 7 Ñ€ÑƒÐ±Ð»ÐµÐ¹ Ð½Ð° Ð±Ð°Ð»Ð°Ð½Ñ Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð°.",
  "Ð¯ Ð´Ð°Ñ€ÑŽ Ñ‚ÐµÐ±Ðµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð²Ð¾ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒÑÑ Ð¼Ð¾Ð¸Ð¼Ð¸ ÑÐ²ÑÐ·ÑÐ¼Ð¸ Ð´Ð»Ñ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð»ÑŽÐ±Ð¾Ð³Ð¾ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐšÑ€Ð¾Ð¼Ðµ Ñ‚Ð¾Ð³Ð¾, Ñ Ð¼Ð¾Ð³Ñƒ Ð¿ÐµÑ€ÐµÐ²ÐµÑÑ‚Ð¸ 7 Ñ€ÑƒÐ±Ð»ÐµÐ¹ Ð½Ð° Ð±Ð°Ð»Ð°Ð½Ñ Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð° Ð² ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð±Ð¾Ð½ÑƒÑÐ°.",
  "Ð¢Ð°Ðº ÐºÐ°Ðº Ñƒ Ð¼ÐµÐ½Ñ ÐµÑÑ‚ÑŒ ÑÐ²ÑÐ·Ð¸, Ð¿Ð¾Ð´Ð°Ñ€ÐºÐ¾Ð¼ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ Ð±ÑƒÐ´ÐµÑ‚ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ Ð´Ð»Ñ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð»ÑŽÐ±Ð¾Ð³Ð¾ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. Ð˜ ÐµÑ‰Ñ‘, Ñ Ð¼Ð¾Ð³Ñƒ Ð¿ÐµÑ€ÐµÐ²ÐµÑÑ‚Ð¸ 7 Ñ€ÑƒÐ±Ð»ÐµÐ¹ Ð½Ð° Ð±Ð°Ð»Ð°Ð½Ñ Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð°.",
  "Ð’ Ð¿Ð¾Ð´Ð°Ñ€Ð¾Ðº Ñ‚ÐµÐ±Ðµ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ÑÑ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð²Ð¾ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒÑÑ Ð¼Ð¾Ð¸Ð¼Ð¸ ÑÐ²ÑÐ·ÑÐ¼Ð¸ Ð´Ð»Ñ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð»ÑŽÐ±Ð¾Ð³Ð¾ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. Ð¢Ð°ÐºÐ¶Ðµ Ñ Ð¼Ð¾Ð³Ñƒ Ð¿ÐµÑ€ÐµÐ²ÐµÑÑ‚Ð¸ 7 Ñ€ÑƒÐ±Ð»ÐµÐ¹ Ð½Ð° Ð±Ð°Ð»Ð°Ð½Ñ Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð° Ð² ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ³Ð¾ Ð¿Ð¾Ð´Ð°Ñ€ÐºÐ°.",
  "Ð£ Ð¼ÐµÐ½Ñ Ð¼Ð½Ð¾Ð³Ð¾ ÑÐ²ÑÐ·ÐµÐ¹ Ð¸ Ñ Ð¿Ñ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ Ñ‚ÐµÐ±Ðµ, Ð² ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð¿Ð¾Ð´Ð°Ñ€ÐºÐ° Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ Ð² Ñ€ÐµÑˆÐµÐ½Ð¸Ð¸ Ð»ÑŽÐ±Ð¾Ð³Ð¾ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. Ð’ Ð´Ð¾Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ, Ñ Ð¼Ð¾Ð³Ñƒ Ð¿ÐµÑ€ÐµÐ²ÐµÑÑ‚Ð¸ 7 Ñ€ÑƒÐ±Ð»ÐµÐ¹ Ð½Ð° Ð±Ð°Ð»Ð°Ð½Ñ Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð°."
];

// ÐÐ±Ð·Ð°Ñ† 5: ÐŸÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ðµ Ð² Ð¼Ð¸Ñ€ Ð°ÑÑÐ¾Ñ†Ð¸Ð°Ñ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸ Ñ Ð¼ÑƒÐ·Ñ‹ÐºÐ¾Ð¹
const paragraph5Variants = [
  "Ð•ÑÐ»Ð¸ Ð¿Ð¾Ð½ÑÑ‚Ð¸Ñ ÑÐ²ÑÐ·ÐµÐ¹ Ð¸ Ð°ÑÑÐ¾Ñ†Ð¸Ð°Ñ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸ ÐµÑ‰Ñ‘ Ð¾ÐºÑƒÑ‚Ð°Ð½Ñ‹ Ñ‚Ð°Ð¹Ð½Ð¾Ð¹ Ð´Ð»Ñ Ñ‚ÐµÐ±Ñ, Ñ Ð¿Ñ€Ð¸Ð³Ð»Ð°ÑˆÐ°ÑŽ Ñ‚ÐµÐ±Ñ Ð² Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ðµ: ÑÐ»ÑƒÑˆÐ°Ð¹ Ð¼ÑƒÐ·Ñ‹ÐºÑƒ Ð¸Ð· Ð¿Ñ€Ð¸ÐºÑ€ÐµÐ¿Ð»Ñ‘Ð½Ð½Ð¾Ð³Ð¾ Ð²Ð¸Ð´ÐµÐ¾Ñ€Ð¾Ð»Ð¸ÐºÐ° ðŸŽ¶, Ð¿Ð¾ÐºÐ° Ñ‡Ð¸Ñ‚Ð°ÐµÑˆÑŒ Ð½Ð°ÑˆÑƒ ÑÑ‚Ð°Ñ‚ÑŒÑŽ Ð¾ Ñ‚ÐµÐ¾Ñ€Ð¸Ð¸ ÑÐ²ÑÐ·ÐµÐ¹, ÐºÐ¾Ñ‚Ð¾Ñ€ÑƒÑŽ Ñ Ð¿Ñ€Ð¾Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°Ð» ÑÑ‚Ð¸ Ð³Ð¾Ð´Ñ‹. Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° ÑÑ‚Ð°Ñ‚ÑŒÑŽ ÑƒÐºÐ°Ð·Ð°Ð½Ð° Ð² Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ð¸ Ðº Ñ€Ð¾Ð»Ð¸ÐºÑƒ.",
  "Ð•ÑÐ»Ð¸ Ð´Ð»Ñ Ñ‚ÐµÐ±Ñ Ð°ÑÑÐ¾Ñ†Ð¸Ð°Ñ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ Ð¾ÑÑ‚Ð°Ñ‘Ñ‚ÑÑ Ð·Ð°Ð³Ð°Ð´ÐºÐ¾Ð¹, Ð¿Ð¾ÑÐ»ÑƒÑˆÐ°Ð¹ Ð¼ÑƒÐ·Ñ‹ÐºÑƒ Ð¸Ð· Ð²Ð¸Ð´ÐµÐ¾Ñ€Ð¾Ð»Ð¸ÐºÐ° ðŸŽµ Ð¸ Ð¾Ð´Ð½Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾ Ð¿Ñ€Ð¾Ñ‡Ñ‚Ð¸ Ð½Ð°ÑˆÑƒ ÑÑ‚Ð°Ñ‚ÑŒÑŽ Ð¾ Ñ‚ÐµÐ¾Ñ€Ð¸Ð¸ Ð°ÑÑÐ¾Ñ†Ð¸Ð°Ñ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸, Ð¾Ñ‚Ñ€Ð°Ð¶Ð°ÑŽÑ‰ÑƒÑŽ Ñ‚Ñ€ÑƒÐ´ Ð²ÑÐµÐ¹ Ð¼Ð¾ÐµÐ¹ Ð¶Ð¸Ð·Ð½Ð¸. Ð¡ÑÑ‹Ð»ÐºÑƒ Ð½Ð° ÑÑ‚Ð°Ñ‚ÑŒÑŽ Ñ‚Ñ‹ Ð½Ð°Ð¹Ð´Ñ‘ÑˆÑŒ Ð² Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ð¸ Ðº Ð²Ð¸Ð´ÐµÐ¾Ñ€Ð¾Ð»Ð¸ÐºÑƒ.",
  "Ð¯ Ð¿Ñ€Ð¸Ð³Ð»Ð°ÑˆÐ°ÑŽ Ñ‚ÐµÐ±Ñ Ð² Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ðµ Ð¿Ð¾ Ð¼Ð¸Ñ€Ñƒ Ð°ÑÑÐ¾Ñ†Ð¸Ð°Ñ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸: Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ñ‡Ñ‚ÐµÐ½Ð¸Ñ ÑÑ‚Ð°Ñ‚ÑŒÐ¸, ÑÐ²Ð»ÑÑŽÑ‰ÐµÐ¹ÑÑ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð¼ Ñ‚Ñ€ÑƒÐ´Ð° Ð²ÑÐµÐ¹ Ð¼Ð¾ÐµÐ¹ Ð¶Ð¸Ð·Ð½Ð¸, ÑÐ»ÑƒÑˆÐ°Ð¹ Ð¿Ñ€Ð¸ÐºÑ€ÐµÐ¿Ð»Ñ‘Ð½Ð½ÑƒÑŽ Ð¼ÑƒÐ·Ñ‹ÐºÑƒ ðŸŽ§. Ð¡ÑÑ‹Ð»ÐºÑƒ Ð½Ð° ÑÑ‚Ð°Ñ‚ÑŒÑŽ Ð¼Ð¾Ð¶Ð½Ð¾ Ð½Ð°Ð¹Ñ‚Ð¸ Ð² Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ð¸ Ðº Ñ€Ð¾Ð»Ð¸ÐºÑƒ.",
  "Ð•ÑÐ»Ð¸ Ñ‚ÐµÐ±Ñ Ñ‚ÐµÐ±Ðµ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ð¾ Ñ€Ð°Ð·Ð³Ð°Ð´Ð°Ñ‚ÑŒ Ñ‡Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ ÑÐ²ÑÐ·Ð¸ Ð¸ Ð°ÑÑÐ¾Ñ†Ð¸Ð°Ñ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ, Ð²ÐºÐ»ÑŽÑ‡Ð¸ Ð¼ÑƒÐ·Ñ‹ÐºÑƒ Ð¸Ð· Ð²Ð¸Ð´ÐµÐ¾Ñ€Ð¾Ð»Ð¸ÐºÐ° ðŸŽ¼ Ð¸ Ð¿Ñ€Ð¾Ñ‡Ñ‚Ð¸ Ð½Ð°ÑˆÑƒ ÑÑ‚Ð°Ñ‚ÑŒÑŽ Ð¾ Ñ‚ÐµÐ¾Ñ€Ð¸Ð¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð¼ Ñ‚Ñ€ÑƒÐ´Ð¾Ð² Ð²ÑÐµÐ¹ Ð¼Ð¾ÐµÐ¹ Ð¶Ð¸Ð·Ð½Ð¸. Ð¡ÑÑ‹Ð»ÐºÑƒ Ð½Ð° ÑÑ‚Ð°Ñ‚ÑŒÑŽ Ð¼Ð¾Ð¶Ð½Ð¾ Ð½Ð°Ð¹Ñ‚Ð¸ Ð² Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ð¸ Ðº Ð²Ð¸Ð´ÐµÐ¾Ñ€Ð¾Ð»Ð¸ÐºÑƒ.",
  "ÐžÑ‚ÐºÑ€Ð¾Ð¹ Ð´Ð»Ñ ÑÐµÐ±Ñ Ð¼Ð¸Ñ€ Ð°ÑÑÐ¾Ñ†Ð¸Ð°Ñ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸: ÑÐ»ÑƒÑˆÐ°Ð¹ Ð¼ÑƒÐ·Ñ‹ÐºÑƒ Ð¸Ð· Ð²Ð¸Ð´ÐµÐ¾Ñ€Ð¾Ð»Ð¸ÐºÐ° ðŸŽ¶, Ð¿Ð¾ÐºÐ° Ñ‡Ð¸Ñ‚Ð°ÐµÑˆÑŒ ÑÑ‚Ð°Ñ‚ÑŒÑŽ Ð¾ Ñ‚ÐµÐ¾Ñ€Ð¸Ð¸ ÑÐ²ÑÐ·ÐµÐ¹, ÑÐ²Ð»ÑÑŽÑ‰ÑƒÑŽÑÑ Ñ‚Ñ€ÑƒÐ´Ð¾Ð¼ Ð²ÑÐµÐ¹ Ð¼Ð¾ÐµÐ¹ Ð¶Ð¸Ð·Ð½Ð¸. Ð¡ÑÑ‹Ð»ÐºÑƒ Ð½Ð° ÑÑ‚Ð°Ñ‚ÑŒÑŽ ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒ Ð² Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ð¸ Ðº Ñ€Ð¾Ð»Ð¸ÐºÑƒ."
];

async function sendBirthdayCongratulations() {
  let offset = 0;
  const currentDate = new Date();
  const currentDay = currentDate.getDate();
  const currentMonth = currentDate.getMonth() + 1;

  while (true) {
    if (offset >= 10000) break;

    const response = await vk.api.friends.get({
      fields: ['bdate'],
      count: 5000,
      offset,
    });

    if (response.items.length === 0) break;

    for (const friend of response.items) {
      if (friend.bdate) {
        const [day, month] = friend.bdate.split('.');
        if (day == currentDay && month == currentMonth) {
          console.log('friend.id', friend.id);

          // ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° ÑÑ‚Ð¸ÐºÐµÑ€Ð°
          enqueueMessage({
            vk,
            response: {
              user_id: friend.id,
              sticker_id: getRandomElement(birthdayStickerIds),
            }
          });

          // Ð¤Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¸Ð· ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ñ‹Ñ… Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð¾Ð² ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ð°Ð±Ð·Ð°Ñ†Ð°
          const finalMessage = `${getRandomElement(paragraph1Variants)}\n\n` +
            `${getRandomElement(paragraph2Variants)}\n\n` +
            `${getRandomElement(paragraph3Variants)}\n\n` +
            `${getRandomElement(paragraph4Variants)}\n\n` +
            `${getRandomElement(paragraph5Variants)}`;

          // ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ñ Ð²Ð¸Ð´ÐµÐ¾Ñ€Ð¾Ð»Ð¸ÐºÐ¾Ð¼
          enqueueMessage({
            vk,
            response: {
              user_id: friend.id,
              message: finalMessage,
              // attachment: getRandomElement(audioAttachments)
              attachment: 'video-3972090_456239795'
            }
          });
        }
      }
    }
    offset += 5000;
  }
}

const trigger = {
  name: "SendBirthdayCongratulations",
  action: async (context) => {
    return await sendBirthdayCongratulations(context);
  }
};

module.exports = {
  trigger
};